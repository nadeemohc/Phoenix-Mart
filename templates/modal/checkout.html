<!-- Checkout Modal -->
<div
  class="modal fade"
  id="checkoutModal"
  tabindex="-1"
  aria-labelledby="checkoutModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form
        id="checkoutForm"
        method="post"
        action="{% url 'order:confirm_order' %}"
        novalidate
      >
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="checkoutModalLabel">Order Summary</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <div class="modal-body">
          <!-- Order Items Table -->
          <div id="checkoutSummary"></div>

          <!-- Address Details -->
          <h5 class="mt-4">Delivery Address</h5>
          <div class="row g-3">
            <div class="col-md-6">
              <label for="full_name" class="form-label">Full Name</label>
              <input
                type="text"
                class="form-control"
                name="full_name"
                id="full_name"
                value="{{ request.user.get_full_name }}"
                required
              />
              <div class="invalid-feedback">Full name is required.</div>
            </div>

            <div class="col-md-6">
              <label for="phone" class="form-label">Phone</label>
              <input
                type="tel"
                class="form-control"
                name="phone"
                id="phone"
                pattern="^[0-9]{10,15}$"
                required
              />
              <div class="invalid-feedback">
                Please enter a valid phone number (10–15 digits).
              </div>
            </div>

            <div class="col-md-6">
              <label for="street" class="form-label">House No / Street</label>
              <input
                type="text"
                class="form-control"
                name="street"
                id="street"
                required
              />
              <div class="invalid-feedback">Street address is required.</div>
            </div>

            <div class="col-md-6">
              <label for="city" class="form-label">City</label>
              <input
                type="text"
                class="form-control"
                name="city"
                id="city"
                required
              />
              <div class="invalid-feedback">City is required.</div>
            </div>

            <div class="col-md-6">
              <label for="state" class="form-label">State</label>
              <input type="text" class="form-control" name="state" id="state" />
              <div class="invalid-feedback">Please provide a state.</div>
            </div>

            <div class="col-md-3">
              <label for="zipcode" class="form-label">Postcode</label>
              <input
                type="text"
                class="form-control"
                name="zipcode"
                id="zipcode"
                pattern="^[A-Za-z0-9\s\-]{4,10}$"
                required
              />
              <div class="invalid-feedback">
                Please enter a valid postcode (4–10 characters).
              </div>
            </div>

            <div class="col-md-3">
              <label for="country" class="form-label">Country</label>
              <input
                type="text"
                class="form-control"
                name="country"
                id="country"
                value="UK"
                required
              />
              <div class="invalid-feedback">Country is required.</div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Confirm Order</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Validation Script -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("checkoutForm");

    form.addEventListener("submit", function (event) {
      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }

      form.classList.add("was-validated");
    });
  });
</script>
